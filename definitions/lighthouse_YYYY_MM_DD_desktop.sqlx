config {
    type: "table",
    schema: "lighthouse",
    name: "2024_06_01_desktop"
}

SELECT
  page AS url,
  lighthouse AS report
FROM
  ${ref('pages')}
WHERE
  date = '${constants.date}'
  AND client = 'desktop'
  AND is_root_page
  AND lighthouse IS NOT NULL
  AND LENGTH(lighthouse) <= 2 * 1024 * 1024 -- legacy tables have a different limit
